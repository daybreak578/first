<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여행 코스 목록</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="여행코스.css">
</head>

<body>
    <div class="event-container">
        <h2>여행코스 정보</h2>
        <div id="eventInfo" >정보를 불러오는 중...</div>
    </div>
    <script>
         let urlParams = new URLSearchParams(window.location.search);
         let contentid = urlParams.get('contentid');

         console.log("contentid", contentid);  // contentid가 제대로 출력되는지 확인

        function fetchContentDetails(contentid) {
            if (!contentid) {
                $("#eventInfo").html("<p>관광 정보가 제공되지 않았습니다.</p>");
                return;
            }

            $.ajax({
                url: "http://apis.data.go.kr/B551011/KorService1/detailInfo1",
                type: "GET",
                data: {
                    serviceKey: "5EPM0JZGu2vix+JS73ESvNyiqPOiAlZvqw7HOMHMsVok5OAlScfevj/AcerZwoWPXx/B6AkWxHZhcfUp0j/aVA==", // API 키 입력
                    MobileApp: "AppTest",
                    MobileOS: "ETC",
                    contentId: "1952975",
                    contentTypeId: "25",  // 여행코스 콘텐츠 유형
                    _type: "json",

                },
                success: function (response) {
                    console.log("API 응답:", response);

                    let items = response.response.body.items.item;
                    if (!items || items.length === 0) {
                        $("#eventInfo").html("<p>데이터를 찾을 수 없습니다.</p>");
                        return;
                    }

                    let item = items[0];  // 첫 번째 데이터

                    function checkValue(value) {
                        return value && value.trim() !== "" ? value : "정보 없음";
                    }

                    let eventInfoHtml = `
            <h2>${checkValue(item.title)}</h2>
            <p><strong>코스이미지설명:</strong> ${checkValue(item.subdetailalt)}</p>
            <p><strong>코스이미지:</strong> ${checkValue(item.subdetailimg)}</p>
            <p><strong>코스개요:</strong> ${checkValue(item.subdetailoverview)}</p>
            <p><strong>코스명:</strong> ${checkValue(item.subname)}</p>
            <img src="${item.firstimage}" alt="이미지 없음" style="max-width:300px;">
        `;

                    $("#eventInfo").html(eventInfoHtml);
                },
                error: function (xhr, status, error) {
                    console.error("API 요청 실패:", error);
                    console.error("상태 코드:", xhr.status);
                    console.error("응답 메시지:", xhr.responseText);
                    $("#eventInfo").html(`<p>데이터를 불러오는 중 오류가 발생했습니다. (${xhr.status})</p>`);
                }

            });
        }

        $(document).ready(function () {
            fetchContentDetails(contentid);  // 페이지가 로드되면 행사 정보를 불러오기
        });

    </script>

</body>

</html>